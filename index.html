<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OP-XY Multisampler Preset Builder</title>
  <link rel="stylesheet" href="/src/style.css">
</head>
<body>
  <div id="app">
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle light mode">
      <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="5"/>
        <line x1="12" y1="1" x2="12" y2="3"/>
        <line x1="12" y1="21" x2="12" y2="23"/>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
        <line x1="1" y1="12" x2="3" y2="12"/>
        <line x1="21" y1="12" x2="23" y2="12"/>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
      </svg>
      <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
    </button>

    <!-- Screen 1: Upload & Configure -->
    <div id="screen-upload" class="screen active">
      <header>
        <h1>OP-XY Multisampler Preset Builder</h1>
      </header>

      <main>
        <div class="step-container">
          <!-- Step 1: Add Samples -->
          <div id="step-samples" class="step visible" data-step="1">
            <div class="step-header">
              <span class="step-number">1</span>
              <span class="step-title">Add Samples</span>
            </div>
            <div class="step-content">
              <div id="drop-zone" class="drop-zone">
                <div class="drop-zone-content">
                  <div class="drop-icon">
                    <svg width="56" height="56" viewBox="0 0 48 48" fill="none">
                      <rect x="8" y="8" width="32" height="32" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M24 16V32M16 24H32" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </div>
                  <p class="drop-text">Drop samples here</p>
                  <p class="drop-subtext">or click to browse</p>
                </div>
                <input type="file" id="file-input" multiple accept="audio/*,.wav,.aiff,.mp3,.m4a,.flac,.ogg">
              </div>

              <div id="file-list" class="file-list hidden">
                <div class="file-list-header">
                  <span id="file-count">0 samples</span>
                  <button id="clear-files" class="text-button">Clear</button>
                </div>
                <ul id="files"></ul>
              </div>

              <button id="step1-continue" class="primary-button step-continue" disabled>
                Continue
              </button>
            </div>
          </div>

          <!-- Step 1.5: Grouping Confirmation (conditional) -->
          <div id="step-grouping" class="step" data-step="1.5">
            <div class="step-header">
              <span class="step-number">&#8226;</span>
              <span class="step-title">Sample Groups Detected</span>
            </div>
            <div class="step-content">
              <p class="grouping-info">
                Found <span id="group-count">0</span> groups based on <span id="pattern-type">pattern</span>
              </p>
              <div id="group-preview" class="group-preview">
                <!-- Group cards will be generated by JS -->
              </div>
              <div class="grouping-actions">
                <button id="use-grouping" class="primary-button">Create Separate Presets</button>
                <button id="skip-grouping" class="text-button">Combine All Into One</button>
              </div>
            </div>
          </div>

          <!-- Step 2: Audio Quality -->
          <div id="step-quality" class="step" data-step="2">
            <div class="step-header">
              <span class="step-number">2</span>
              <span class="step-title">Audio Quality</span>
            </div>
            <div class="step-content">
              <div class="option-cards">
                <label class="option-card">
                  <input type="radio" name="quality" value="standard">
                  <div class="option-card-content">
                    <span class="option-card-label">Standard</span>
                    <span class="option-card-desc">44.1kHz</span>
                  </div>
                </label>
                <label class="option-card">
                  <input type="radio" name="quality" value="high">
                  <div class="option-card-content">
                    <span class="option-card-label">High</span>
                    <span class="option-card-desc">48kHz</span>
                  </div>
                </label>
                <label class="option-card">
                  <input type="radio" name="quality" value="lofi" checked>
                  <div class="option-card-content">
                    <span class="option-card-label">OP-XY</span>
                    <span class="option-card-desc">22kHz</span>
                  </div>
                  <span class="option-card-badge">recommended</span>
                </label>
              </div>
              <button id="step2-continue" class="primary-button step-continue">
                Continue
              </button>
            </div>
          </div>

          <!-- Step 3: Bit Depth -->
          <div id="step-bitdepth" class="step" data-step="3">
            <div class="step-header">
              <span class="step-number">3</span>
              <span class="step-title">Bit Depth</span>
            </div>
            <div class="step-content">
              <div class="option-cards">
                <label class="option-card">
                  <input type="radio" name="bitdepth" value="standard" checked>
                  <div class="option-card-content">
                    <span class="option-card-label">16-bit</span>
                    <span class="option-card-desc">Smaller files</span>
                  </div>
                  <span class="option-card-badge">recommended</span>
                </label>
                <label class="option-card">
                  <input type="radio" name="bitdepth" value="high">
                  <div class="option-card-content">
                    <span class="option-card-label">24-bit</span>
                    <span class="option-card-desc">Higher fidelity</span>
                  </div>
                </label>
              </div>
              <button id="step3-continue" class="primary-button step-continue">
                Continue
              </button>
            </div>
          </div>

          <!-- Step 4: Sample Density (conditional) -->
          <div id="step-density" class="step" data-step="4">
            <div class="step-header">
              <span class="step-number">4</span>
              <span class="step-title">Sample Density</span>
            </div>
            <div class="step-content">
              <p id="density-recommendation" class="density-recommendation"></p>
              <div class="option-cards">
                <label class="option-card">
                  <input type="radio" name="density" value="full">
                  <div class="option-card-content">
                    <span class="option-card-label">Full</span>
                    <span class="option-card-desc" id="density-full-desc">Up to 24</span>
                  </div>
                </label>
                <label class="option-card">
                  <input type="radio" name="density" value="balanced" checked>
                  <div class="option-card-content">
                    <span class="option-card-label">Balanced</span>
                    <span class="option-card-desc" id="density-balanced-desc">8-12</span>
                  </div>
                  <span class="option-card-badge">recommended</span>
                </label>
                <label class="option-card">
                  <input type="radio" name="density" value="lite">
                  <div class="option-card-content">
                    <span class="option-card-label">Lite</span>
                    <span class="option-card-desc" id="density-lite-desc">4-5</span>
                  </div>
                </label>
              </div>
              <button id="step4-continue" class="primary-button step-continue">
                Continue
              </button>
            </div>
          </div>

          <!-- Step 5: Name & Create -->
          <div id="step-name" class="step" data-step="5">
            <div class="step-header">
              <span class="step-number">5</span>
              <span class="step-title">Name Your Preset</span>
            </div>
            <div class="step-content">
              <div class="form-section preset-name-section">
                <input type="text" id="preset-name" placeholder="My Instrument" maxlength="30">
              </div>
              <button id="create-btn" class="primary-button">
                Create Preset
              </button>
            </div>
          </div>
        </div>

        <div id="warnings" class="warnings hidden"></div>
      </main>
    </div>

    <!-- Screen 2: Manual Note Assignment -->
    <div id="screen-assign" class="screen">
      <header>
        <h1>Assign Notes</h1>
      </header>

      <main>
        <!-- Reference Keyboard -->
        <div class="keyboard-section">
          <div class="keyboard-controls">
            <button id="octave-down" class="octave-btn">-</button>
            <span id="current-octave">C4</span>
            <button id="octave-up" class="octave-btn">+</button>
          </div>
          <div id="keyboard" class="keyboard">
            <!-- Keys will be generated by JS -->
          </div>
          <p id="played-note" class="played-note-display">-</p>
        </div>

        <!-- Unassigned Samples List -->
        <div class="assign-section">
          <h3 id="assign-count">0 samples need assignment</h3>
          <div id="unassigned-list" class="unassigned-list">
            <!-- Samples will be added by JS -->
          </div>
        </div>

        <button id="finish-assign-btn" class="primary-button">
          Continue
        </button>
      </main>
    </div>

    <!-- Screen 3: Processing -->
    <div id="screen-processing" class="screen">
      <main class="centered">
        <div class="loader">
          <div class="loader-dots">
            <span></span><span></span><span></span><span></span><span></span>
            <span></span><span></span><span></span><span></span>
          </div>
        </div>
        <h2>Creating your preset</h2>
        <p id="processing-status" class="status-text">Analyzing samples...</p>
      </main>
    </div>

    <!-- Screen 4: Complete -->
    <div id="screen-complete" class="screen">
      <main class="centered">
        <div class="success-icon">
          <svg width="72" height="72" viewBox="0 0 64 64" fill="none">
            <circle cx="32" cy="32" r="29" stroke="currentColor" stroke-width="2"/>
            <path d="M20 32L28 40L44 24" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>

        <h2 id="complete-title">"My Preset" is ready</h2>

        <button id="download-btn" class="primary-button">
          Download Preset
        </button>

        <p id="preset-info" class="info-text">12 samples â€¢ 2.4 MB</p>

        <div class="instructions">
          <h3>Quick Start</h3>
          <ol>
            <li>Unzip the download</li>
            <li>Connect OP-XY in disk mode</li>
            <li>Copy the <code>.preset</code> folder to <code>presets/</code></li>
            <li>Eject disk and the preset will appear</li>
          </ol>
        </div>

        <button id="restart-btn" class="text-button">
          Create Another
        </button>
      </main>
    </div>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
